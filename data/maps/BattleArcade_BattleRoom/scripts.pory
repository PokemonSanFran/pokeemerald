const ATTENDANT_ENTRANCE = 1
const ATTENDANT = 1
const OPPONENT = 2
const MC = 3
const VAR_NEED_TO_FACE_NORTH = VAR_TEMP_1
const VAR_ARCADE_EVENT = VAR_UNUSED_0x4083

const VAR_ARCADE_IMPACT_SIDE = VAR_UNUSED_0x404E

const GAME_BOARD_EVENT =  VAR_0x8007
const GAME_BOARD_IMPACT = VAR_0x8008
const GAME_BOARD_SUCCESS = VAR_0x8009

const PLAYER = OBJ_EVENT_ID_PLAYER
const CAMERA = OBJ_EVENT_ID_CAMERA

mapscripts BattleArcade_BattleRoom_MapScripts
{
    MAP_SCRIPT_ON_FRAME_TABLE
    [
        VAR_TEMP_0, 0: BattleArcade_BattleRoom_EventScript_EnterRoom
        VAR_TEMP_0, 1: BattleFrontier_RouletteRoom_EventScript_BeginChallenge
    ]
    MAP_SCRIPT_ON_WARP_INTO_MAP_TABLE
    [
        VAR_NEED_TO_FACE_NORTH, 0: BattleArcade_BattleRoom_EventScript_PlayerFaceNorth
    ]
}

script BattleArcade_BattleRoom_EventScript_PlayerFaceNorth
{
    setvar(VAR_NEED_TO_FACE_NORTH, 1)
    turnobject(PLAYER, DIR_NORTH)
    end
}

script BattleArcade_BattleRoom_EventScript_EnterRoom
{
    setvar(VAR_TEMP_0, 1)
    special(SpawnCameraObject)
    applymovement(ATTENDANT, BattleArcade_BattleRoom_WatchPlayer)
    applymovement(PLAYER, BattleArcade_BattleRoom_Player_WalkToBattlefield)
    applymovement(CAMERA, BattleArcade_BattleRoom_Camera_PanBattlefield)
    waitmovement(CAMERA)
    waitmovement(PLAYER)
    applymovement(PLAYER, BattleArcade_BattleRoom_Movement_FaceBattlefield)
    special(RemoveCameraObject)
}

script BattleArcade_BattleRoom_EventScript_SpawnOpponentEntrance
{
    addobject(OPPONENT) // ARCADE TODO opponent is always invisible here
    setobjectxy(OPPONENT,7,11)
    //setobjectxy(OPPONENT,7,6)
    applymovement(OPPONENT,BattleFrontier_BattleArcadeBattleRoom_Movement_OpponentEnter)
    waitmovement(OPPONENT)
}

script BattleArcade_BattleRoom_EventScript_MCFaceCrowd
{
    applymovement(MC,BattleFrontier_BattleArcadeBattleRoom_Movement_FaceCrowd)
    waitmovement(MC)
}

script BattleArcade_BattleRoom_EventScript_MCMoveIntoPosition
{
    applymovement(MC,BattleFrontier_BattleArcadeBattleRoom_Movement_WalkDown)
    waitmovement(MC)
}

script BattleArcade_BattleRoom_EventScript_OpponentBattleMovement
{
    applymovement(OPPONENT,Common_Movement_WalkInPlaceLeft)
    waitmovement(OPPONENT)
}

script BattleArcade_BattleRoom_EventScript_MoveBattlersIntoPosition
{
    lock
    special(SpawnCameraObject)
    applymovement(OPPONENT,BattleArcade_BattleRoom_EventScript_WalkToLeft)
    applymovement(PLAYER,BattleArcade_BattleRoom_EventScript_WalkToRight)
    waitmovement(PLAYER)
}

script BattleArcade_BattleRoom_EventScript_ApplyOverworldImpact
{
    switch(var(GAME_BOARD_IMPACT))
    {
        case ARCADE_IMPACT_PLAYER:
            applymovement(MC,Common_Movement_FacePlayer)
        case ARCADE_IMPACT_OPPONENT:
            applymovement(MC,Common_Movement_FaceAwayPlayer)
        case ARCADE_IMPACT_ALL:
            return
    }
    waitmovement(MC)
    delay(16)
    //arcade_playoverworldeffect
}

script BattleArcade_BattleRoom_EventScript_MoveMCBack
{
    applymovement(MC,BattleFrontier_BattleArcadeBattleRoom_Movement_MoveBack)
    waitmovement(MC)
}

script BattleArcade_BattleRoom_EventScript_MoveBattlersBack
{
    special(SpawnCameraObject) //ARCADE TODO Why does the camera move here?
    applymovement(CAMERA,BattleArcade_BattleRoom_EventScript_WalkToRight)
    applymovement(PLAYER,BattleArcade_BattleRoom_EventScript_ReturnPosition)
    applymovement(OPPONENT,BattleArcade_BattleRoom_Movement_OpponentReturnPosition)
    waitmovement(OPPONENT)
    applymovement(OPPONENT,BattleArcade_BattleRoom_Movement_LeaveRoom)
    waitmovement(OPPONENT)
    removeobject(OPPONENT)
}

script BattleArcade_BattleRoom_EventScript_HandleHealAttendantMovement
{
    addobject(ATTENDANT)
    setobjectxy(ATTENDANT,2,12)
    applymovement(ATTENDANT,BattleArcade_BattleRoom_Movement_RunToHeal)
    waitmovement(ATTENDANT)
    applymovement(PLAYER,BattleArcade_BattleRoom_Movement_FaceAttendant)
    waitmovement(PLAYER)
}

script BattleArcade_BattleRoom_EventScript_AttendantLeave
{
    applymovement(PLAYER, BattleArcade_BattleRoom_Movement_FaceBattlefield)
    applymovement(ATTENDANT,BattleArcade_BattleRoom_Movement_RunOffBattlefield)
    waitmovement(ATTENDANT)
    removeobject(ATTENDANT)
}

script BattleArcade_BattleRoom_EventScript_BrainEntranceMovement
{
}

movement BattleArcade_BattleRoom_Movement_RunOffBattlefield
{
   walk_faster_down * 5
}

movement BattleArcade_BattleRoom_Movement_FaceBattlefield
{
    walk_in_place_faster_right
}

movement BattleArcade_BattleRoom_EventScript_WalkToLeft
{
    walk_left
}

movement BattleArcade_BattleRoom_EventScript_WalkToRight
{
    walk_right
}

movement BattleFrontier_BattleArcadeBattleRoom_Movement_MoveBack
{
    walk_up
    walk_in_place_fast_down
}

movement BattleFrontier_BattleArcadeBattleRoom_Movement_FaceCrowd
{
    face_down
}

movement BattleFrontier_BattleArcadeBattleRoom_Movement_WalkDown
{
    walk_down
}

movement BattleFrontier_BattleArcadeBattleRoom_Movement_OpponentEnter
{
    set_visible
    walk_up * 2
    walk_right * 4
    walk_up * 3
    walk_in_place_faster_left
}

movement BattleArcade_BattleRoom_WatchPlayer
{
    delay_8
    delay_8
    face_up
}

movement BattleArcade_BattleRoom_Player_WalkToBattlefield
{
    walk_up * 8
    walk_left * 4
    walk_up * 3
}

movement BattleArcade_BattleRoom_Camera_PanBattlefield
{
    walk_up * 12
}

movement BattleArcade_BattleRoom_EventScript_ReturnPosition
{
    walk_left
    walk_in_place_right
}

movement BattleArcade_BattleRoom_Movement_OpponentReturnPosition
{
    walk_right
}

movement BattleArcade_BattleRoom_Movement_LeaveRoom
{
    walk_down * 2
    walk_left * 4
    walk_down * 3
}

movement BattleArcade_BattleRoom_Movement_RunToHeal
{
    walk_faster_up * 6
    walk_in_place_faster_right
}

movement BattleArcade_BattleRoom_Movement_FaceAttendant
{
    walk_in_place_left
}
